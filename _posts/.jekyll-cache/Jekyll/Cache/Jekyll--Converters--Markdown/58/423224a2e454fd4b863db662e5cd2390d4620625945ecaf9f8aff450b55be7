I";<!-- 数学公式 -->
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
      inlineMath: [['$','$']]
    }
  });
</script>

<h1 id="lecture-12-集成学习">Lecture 12 集成学习</h1>
<h2 id="主要内容">主要内容</h2>
<ul>
  <li><strong>集成学习：对冲你的赌注</strong></li>
  <li><strong>Bagging 和随机森林</strong></li>
  <li><strong>Boosting</strong></li>
  <li><strong>Stacking</strong></li>
</ul>

<h2 id="1-集成学习">1. 集成学习</h2>
<p><strong>集成学习：对冲你的赌注</strong></p>
<h3 id="11-为什么是-一个真实的-模型">1.1 为什么是 “一个真实的” 模型？</h3>
<ul>
  <li>到目前为止，我们已经讨论了各个模型，并在孤立 / 竞争中考虑了每个模型</li>
  <li>我们知道如何评估每个模型的性能（通过准确率、F-measure 等），这使我们能够给一个数据集从 <strong>总体上</strong> 选择出最优的模型</li>
  <li>但 <strong>总体上</strong> 并没有隐含着每个样本的表现
    <ul>
      <li>总体上最优的模型：在某些实例上可能会出错</li>
      <li>总体上最差的模型：在某些实例上可能会更好</li>
    </ul>
  </li>
  <li><span style="color:red">集成</span> 让我们可以综合使用多个模型</li>
</ul>

<h3 id="12-专家小组">1.2 专家小组</h3>
<ul>
  <li>考虑一个由 3 位专家组成的小组，他们 <span style="color:red">各自独立地</span> 做出分类决策。每个专家决策出错的概率都是 0.3。共识决策由 <span style="color:red">多数投票</span> 产生。</li>
</ul>

<p><strong><span style="color:steelblue">思考：共识决策出错的概率是多少？</span></strong>
在共识决策下，出错可能有两种情况：<br />
a. 3 位专家都出错了<br />
b. 2 位专家出错了导致最终投票得出错误答案<br />
所以，将两种情况的概率相加即可：<br />
$0.3^3+3\times 0.3^2\times (1-0.3)=0.216$</p>

<ul>
  <li>设置：错误之间互相独立，每一个的概率都是 $p$</li>
  <li>
    <p>$n$ 个专家各自决策产生的 <strong>错误的数量</strong> 服从 <span style="color:red">二项分布</span> $\color{red}{\text{Binom}(n,p)}$</p>

    <script type="math/tex; mode=display">\Pr(k)=\begin{pmatrix}n \\ k\end{pmatrix}p^k(1-p)^{n-k}</script>
  </li>
  <li>当 <span style="color:red">至少</span> $\color{red}{\lceil n/2 \rceil}$ <span style="color:red">的专家出错</span>（对于 $n$ 为奇数的情况）时，多数投票将会出错<br />
<script type="math/tex">\Pr(panel\, error)=\sum_{k=\lceil n/2 \rceil}^{n}\begin{pmatrix}n \\ k\end{pmatrix}p^k(1-p)^{n-k}</script></li>
</ul>

<p><img src="http://andy-blog.oss-cn-beijing.aliyuncs.com/blog/2020-02-16-WX20200216-201831%402x.png" width="80%" /></p>

<h3 id="13-组合模型">1.3 组合模型</h3>
<ul>
  <li>模型组合（又称 <span style="color:red">集成学习</span>）根据给定的训练集构造一个基模型（又称 <span style="color:red">基学习器</span>）的集合，并将输出汇总到一个单独的元模型中（<span style="color:red">集成</span>）
    <ul>
      <li>分类问题采用（加权）多数投票</li>
      <li>回归问题采用（加权）平均</li>
      <li>更一般地：<em>元模型</em> $=f($<em>基模型</em>$)$</li>
    </ul>
  </li>
  <li>
    <p>回忆 <strong>偏差-方差权衡</strong>：</p>

    <script type="math/tex; mode=display">\Bbb E\left[ l\left(y,\hat f(\boldsymbol x_0)\right) \right]=\left(\Bbb E[y]-\Bbb[\hat f]\right)^2+Var[\hat f]+Var[y]</script>

    <script type="math/tex; mode=display">\text{test error}=(\text{bias})^2+\text{variance}+\text{irreducible \frak {error}}</script>
  </li>
</ul>

<p>模型组合（又称为集合学习）根据给定的训练集构造一组基本模型（又称为基本学习者），并将输出汇总到单个元模型（集合）中</p>

<p>下节内容：集成学习</p>
:ET