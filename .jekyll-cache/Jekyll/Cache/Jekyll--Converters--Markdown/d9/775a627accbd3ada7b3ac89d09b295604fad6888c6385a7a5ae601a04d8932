I"v$<h1 id="lecture-04--分类">Lecture 04  分类</h1>

<p><strong>参考教材</strong>：</p>

<ul>
  <li><em>Gareth, J., Daniela, W., Trevor, H., &amp; Robert, T. (2013). An intruduction to statistical learning: with applications in R. Spinger.</em></li>
  <li><em>Hastie, T., Tibshirani, R., &amp; Friedman, J. (2009). The elements of statistical learning: data mining, inference, and prediction. Spinger Science &amp; Business Media.</em></li>
</ul>

<h2 id="1-分类问题概述">1. 分类问题概述</h2>

<p>上节课中我们所讨论的线性回归模型假设响应变量 $Y$ 是定量的，但很多情况下，响应变量是 <strong>定性的 (qualitative)</strong>。例如，眼睛颜色是定性变量，取值蓝色或棕色。定性变量又称 <strong>分类 (categorical)</strong> 变量。本节课我们将学习预测定性响应变量的方法及 <strong>分类 (classification)</strong> 过程。预测一个观测的定性响应值也指对观测 <strong>分类 (classify)</strong>，因为它涉及将观测分配到一个类别中。另一方面，大部分的分类方法先从预测定性变量不同类别的概率开始，将分类问题作为概率估计的一个结果。从这个角度上看，分类与回归方法有许多类似之处。</p>

<p>如今许多 <strong>分类器 (calssifier)</strong> 已被开发出来用于预测定性响应变量值。我们之前已经接触过一部分，这节课中，我们将讨论三种应用最广泛的分类方法：<strong>逻辑回归 (logistìc regression)</strong>、<strong>线性判别分析 (linear discriminant analysis)</strong> 和 <strong>$K$ 最近邻 ($K$-nearest neighbours)</strong>。在后面课程中，我们将会讨论更多的数据密集型计算方法，例如广义可加模型、基于树的方法、随机森林、boosting，以及支持向量机。</p>

<p>定性变量取值为 <strong>无序集合 $\mathcal C$</strong> 中的值，例如：</p>

<ul>
  <li>$\texttt{eye color}\in\{\mathtt{brown, blue, green}\}$</li>
  <li>$\texttt{email}\in\{\mathtt{spam, ham}\}$</li>
</ul>

<p>给定一个特征向量 $X$ 和一个定性响应 $Y$，其中响应变量 $Y$ 在集合 $\mathcal C$ 中取值。分类任务就是构建一个函数 $C(X)$，该函数将特征向量 $X$ 作为输入并预测其 $Y$ 值；即 $C(X) \in \mathcal C$。</p>

<p>通常，我们更感兴趣的是对 $X$ 属于 $\mathcal C$ 中每个类别的 <strong>概率</strong> 进行估计。</p>

<p>例如，对保险索赔是欺诈的概率进行估计要比将其直接分类为是否欺诈更具实际意义。</p>

<h3 id="例子信用卡违约">例子：信用卡违约</h3>

<p><img src="http://andy-blog.oss-cn-beijing.aliyuncs.com/blog/2020-11-07-WX20201107-132447%402x.png" width="80%" /></p>

<p><span style="font-size:10pt"> <span style="color:steelblue;font-weight:bold">图 1</span>：<code class="language-plaintext highlighter-rouge">Default</code> 数据集。<strong>左图</strong>：部分个体的年收入与月信用卡余额关系。信用卡违约的个体标记为 “$+$”，未违约的个体标记为 “$\circ$”。<strong>中图</strong>：<code class="language-plaintext highlighter-rouge">default</code> 关于 <code class="language-plaintext highlighter-rouge">balance</code> 函数的箱型图。<strong>右图</strong>：<code class="language-plaintext highlighter-rouge">default</code> 关于 <code class="language-plaintext highlighter-rouge">income</code> 函数的箱型图。</span></p>

<h2 id="2-为什么线性回归不可用">2. 为什么线性回归不可用</h2>

<p>假设在上面的 <code class="language-plaintext highlighter-rouge">Default</code> 分类任务中，我们将响应变量编码为：</p>

<script type="math/tex; mode=display">% <![CDATA[
Y=\begin{cases}0 & \text{if }\texttt{NO} \\[2ex] 1 & \text{if }\texttt{YES}\end{cases} %]]></script>

<p>我们可以简单地对 $X$ 进行 $Y$ 的线性回归，并且如果 $Y&gt; 0.5$ 就将其分类为 $\texttt{YES}$ 吗？</p>

<ul>
  <li>在这种二元结果的情况下，线性回归可以很好地用作分类器，并且它等效于我们稍后将讨论的 <strong>线性判别分析</strong>。</li>
  <li>由于总体的 $E(Y\mid X=x)=\Pr (Y=1\mid X=x)$，我们可能认为回归可以完美解决此任务。</li>
  <li>然而，<strong>线性</strong> 回归可能会产生小于 $0$ 或大于 $1$ 的概率。因此，<strong>逻辑回归 (logistic regression)</strong> 更为合适。</li>
</ul>

<p><img src="http://andy-blog.oss-cn-beijing.aliyuncs.com/blog/2020-11-07-WX20201107-134623%402x.png" width="80%" /></p>

<p><span style="font-size:10pt"> <span style="color:steelblue;font-weight:bold">图 2</span>：<code class="language-plaintext highlighter-rouge">Default</code> 数据分类。<strong>左图</strong>：线性回归估计的 <code class="language-plaintext highlighter-rouge">default</code> 概率。可以看到，其中一些数据上估计的概率值是负数。橙色标记表示按照 $0/1$ 编码的 <code class="language-plaintext highlighter-rouge">default</code> 值 ($\texttt{NO}$ 或 $\texttt{YES}$)。<strong>右图</strong>：逻辑回归预测的 <code class="language-plaintext highlighter-rouge">default</code> 概率，所有估计的概率均落在 $0$ 到 $1$ 之间。</span></p>

<p>橙色标记表示响应 $Y$ 为 $0$ 或 $1$。可以看到，线性回归无法很好地估计 $\Pr(Y=1\mid X)$，而逻辑回归似乎非常适合该任务。</p>

<p>现在，假设我们有一个具有三种可能值的响应变量。例如，对于急诊室中的病人，我们需要根据他们的症状对其进行分类：<code class="language-plaintext highlighter-rouge">stroke</code> (中风)、<code class="language-plaintext highlighter-rouge">drug overdose</code> (服药过量) 和 <code class="language-plaintext highlighter-rouge">epileptic seizure</code> (癫痫发作)。考虑用一个定量的响应变量 $Y$ 对这些值编码：</p>

<script type="math/tex; mode=display">% <![CDATA[
Y=\begin{cases}1 & \text{if }\texttt{stroke} \\[2ex] 2 & \text{if }\texttt{drug overdose}\\[2ex] 3 & \text{if }\texttt{epileptic seizure}\end{cases} %]]></script>

<p>我们可以根据这些编码，并结合一系列预测变量 $X_1,\dots,X_p$ 通过最小二乘法建立线性回归模型来预测 $Y$。</p>

<p>但是，这种做法存在一个问题：上面的编码方式实际默认了一个有序的输出，它实际上暗示了 <code class="language-plaintext highlighter-rouge">stroke</code> 和 <code class="language-plaintext highlighter-rouge">drug overdose</code> 之间的差异与 <code class="language-plaintext highlighter-rouge">drug overdose</code> 和 <code class="language-plaintext highlighter-rouge">epileptic seizure</code> 之间的差异是相同的。然而，实际上并没有特别的原因必需这样。例如，我们同样可以选择另一种编码，将三者位置交换。不同的编码将产生完全不同的线性模型，继而导致对于同一测试观测产生不同的预测类别。</p>

<p>如果响应变量值确实存在一个自然的程度顺序，例如温和、中等和剧烈，并且温和和中等的程度差距与中等和剧烈的程度差距是相近的，那么将其编码为 $1,2,3$ 是合理的。但是请注意，通常我们不能将一个定性的响应变量自然地转换为两个水平以上的</p>

<p>中得阔 的程度茬距与中锋和剧割的程度差距盖板近的?那么七 2. 3 的绵阳就是合理的。 ffii要)3:茧的 是，通常不能冉 ω个定性的响应坚盘自措地转化到两水等山上的Æ盐萤盘朱建立线性邵阳模型c</p>

<p><span style="font-size:10pt"> <span style="color:steelblue;font-weight:bold">表 10</span>：<code class="language-plaintext highlighter-rouge">Auto</code> 数据集中，<code class="language-plaintext highlighter-rouge">mpg</code> 关于 <code class="language-plaintext highlighter-rouge">horsepower</code> 及其平方项的回归模型的最小二乘系数估计。</span></p>

<table>
  <thead>
    <tr>
      <th> </th>
      <th style="text-align: center">系数</th>
      <th style="text-align: center">标准误</th>
      <th style="text-align: center">t 统计量</th>
      <th style="text-align: center">p 值</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">Intercept</code></td>
      <td style="text-align: center">$56.9001$</td>
      <td style="text-align: center">$1.8004$</td>
      <td style="text-align: center">$31.6$</td>
      <td style="text-align: center">$&lt; 0.0001$</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">horsepower</code></td>
      <td style="text-align: center">$-0.4662$</td>
      <td style="text-align: center">$0.0311$</td>
      <td style="text-align: center">$-15.0$</td>
      <td style="text-align: center">$&lt; 0.0001$</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">horsepower</code>$^2$</td>
      <td style="text-align: center">$0.0012$</td>
      <td style="text-align: center">$0.0001$</td>
      <td style="text-align: center">$10.1$</td>
      <td style="text-align: center">$&lt; 0.0001$</td>
    </tr>
  </tbody>
</table>

<p>下节内容：分类</p>
:ET