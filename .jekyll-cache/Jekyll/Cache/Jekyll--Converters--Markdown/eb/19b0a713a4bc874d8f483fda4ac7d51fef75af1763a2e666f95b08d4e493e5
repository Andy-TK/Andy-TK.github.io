I"S<h1 id="lecture-11-聚类分析">Lecture 11 聚类分析</h1>

<p><strong>参考教材</strong>：</p>

<ul>
  <li><em>Hardle, W. and Simar, L (2015). Applied multivariate statistical analysis, 4th edition.</em></li>
  <li><em>Hastie, T. Tibshirani, R. and Friedman, J. (2009). The elements of statistical learning, 2nd edition</em></li>
</ul>

<h2 id="1-主成分回归">1. 主成分回归</h2>

<p><img src="http://andy-blog.oss-cn-beijing.aliyuncs.com/blog/2020-11-21-WX20201122-004902%402x.png" width="80%" /></p>

<p><span style="margin:auto; display:table; font-size:10pt"> <span style="color:steelblue;font-weight:bold">图 1</span>：<strong>左上</strong>：当 $n=30$ 时，情况 (i)。<strong>右上</strong>：当 $n=100$ 时，情况 (i)。<strong>左下</strong>：当 $n=30$ 时，情况 (ii)。<strong>右下</strong>：当 $n=100$ 时，情况 (ii)。每张图中，左侧是 PLS 模型，右侧是 PCA 模型，每一侧从左到右依次为 $q=1,\dots,10$ 时，均方预测误差 PE 的箱型图。</span></p>

<p><img src="http://andy-blog.oss-cn-beijing.aliyuncs.com/blog/2020-11-21-WX20201122-004926%402x.png" width="80%" /></p>

<p><span style="margin:auto; display:table; font-size:10pt"> <span style="color:steelblue;font-weight:bold">图 2</span>：<strong>左上</strong>：当 $n=30$ 时，情况 (iii)。<strong>右上</strong>：当 $n=100$ 时，情况 (iii)。<strong>左下</strong>：当 $n=30$ 时，情况 (iv)。<strong>右下</strong>：当 $n=100$ 时，情况 (iv)。每张图中，左侧是 PLS 模型，右侧是 PCA 模型，每一侧从左到右依次为 $q=1,\dots,10$ 时，均方预测误差 PE 的箱型图。</span></p>

<p>可以看到，PCA 的均方预测误差的走势与四种情况下的 PC 有着非常直接的关系，当 PC 中包含 $X$ 和 $Z$ 的交互信息时，PCA 的均方预测误差将呈现下降趋势。例如，图 1 中上面两张图对应情况 (i)，即 $X$ 和 $Z$ 的交互信息包含在前 5 个 PC 中，因此当 $q$ 从 $1$ 增加到 $5$ 时，PCA 的均方预测误差呈现下降趋势，随后逐渐平稳，或者可能略微上升 (后面引入的 PC 对模型的损害大于帮助)；而图 1 中下面两张图对应情况 (ii)，即 $X$ 和 $Z$ 的交互信息包含在第 6 到第 10 个 PC 中，因此当 $q$ 从 $1$ 增加到 $5$ 时，PCA 的均方预测误差没有变化，或者略微上升，而当 $q$ 从 $6$ 增加到 $10$ 时，PCA 的均方预测误差呈现明显下降趋势。图 2 中，由于情况 (iii) 和 (iv) 中，$X$ 和 $Z$ 的交互信息都包含在第 $10$ 个之后的 PC 中，所以图中当 $q$ 从 $1$ 增加到 $10$ 的过程中，PCA 的均方预测误差的变化并不显著。</p>

<p>而对于 PLS，由于它和 PC 并不直接相关，而是取决于线性投影 $T_j$。因此，PLS 的均方预测误差的走势与四种 PC 情况之间的关系并不像 PCA 那样明显。以图 1 中左上图为例，随着 $q$ 从 $1$ 增加到 $10$，PLS 的均方预测误差先下降后上升，最低点位于 $q=3$ 处，这意味着前 $3$ 个 PC 中已经包含了大部分 $X$ 和 $Z$ 的交互信息，后面再增加的 PC 只是给模型引入了不必要的方差。总体来看，对于达到相同的均方预测误差，PLS 需要的成分数量通常要比 PCA 更少，这也表明 PLS 的计算效率通常要高于 PCA。</p>

<p>下节内容：因子分析</p>
:ET