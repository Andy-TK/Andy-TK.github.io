I"<h1 id="lecture-03-容错">Lecture 03 容错</h1>

<p><strong>参考教材</strong>：<em>Transaction Processing: Concepts and Techniques, Jim Gray and Andreas Reuter, Morgan Kaufmann, 1993</em></p>

<p>这节课我们将介绍有关 <strong>容错 (Fault Tolerance)</strong> 的概念，该属性使系统在某些组件发生故障时能够继续正常运行。</p>

<h2 id="1-概率基础">1. 概率基础</h2>
<p>在正式介绍容错之前，我们将先回顾一些概率相关知识。</p>

<ul>
  <li>
    <p>$P(A)=$ 事件 $A$ 在 <strong>特定时期内</strong> 发生的概率</p>

    <p><br /></p>
  </li>
  <li>
    <p>$P(A \cap B)=$ 在这段时期内事件 $A$ 和 $B$ 都发生的概率<br />
如果 $A$ 和 $B$ 互为独立事件，那么</p>

    <script type="math/tex; mode=display">P(A \cap B)=P(A)\times P(B)</script>

    <p><br /></p>
  </li>
  <li>
    <p>$P(A \cup B)= P(A) + P(B) - P(A\cap B)$<br />
如果 $A$ 和 $B$ 互为独立事件，那么</p>

    <script type="math/tex; mode=display">% <![CDATA[
\begin{align} P(A \cup B) &= P(A)+P(B)-P(A)\times P(B) \\
&= P(A)+P(B)\qquad  (如果\, P(A)\, 和\, P(B)\, 非常小)\end{align} %]]></script>

    <p><br /></p>
  </li>
  <li>
    <p>事件发生的平均时间 $MT(A)=1/P(A)$</p>

    <p><br /></p>
  </li>
  <li>
    <p>如果事件 $A$ 和 $B$ 的平均时间分别为 $MT(A)$ 和 $MT(B)$，那么到第一次事件发生的平均时间为</p>

    <script type="math/tex; mode=display">MT(A\cup B)=\dfrac{1}{P(A\cup B)}=\dfrac{1}{P(A)+P(B)-P(A\cap B)}</script>

    <p>假设 $P(A)$ 和 $P(B)$ 都非常小，那么我们可以认为 $P(A\cap B)\approx 0$。因此，在容错问题中，我们可以认为两个系统同时发生故障的概率非常低，此时</p>

    <script type="math/tex; mode=display">MT(A\cup B)=\dfrac{1}{P(A)+P(B)}</script>
  </li>
</ul>

<h2 id="2-容错">2. 容错</h2>

<p><img src="http://andy-blog.oss-cn-beijing.aliyuncs.com/blog/2020-07-21-WX20200721-194103%402x.png" /></p>

<p>可以看到，在启动之后，系统先是正常运行，然后出现了一次故障使得系统宕机，然后经过一段时间修复，系统重新开始运行，一段时间后，系统再次由于故障宕机。</p>

<p><strong>模块可用性 (Module availability)</strong>：衡量服务完成与运行时间的比率。计算公式如下：</p>

<script type="math/tex; mode=display">=\dfrac{\text{Mean time to failure}}{\text{Mean time to failure} + \text{mean time to repair}}</script>

<p>如果所有的 $n$ 个事件都具有相同的平均时间 $m$，那么这些事件中的某一个第一次发生的平均时间为：$m/n$。</p>

<p>推导过程：</p>

<p>如果 $p$ 是一个事件在给定时间内发生的概率，那么其平均时间为：$m=\dfrac$</p>

<p>下节内容：容错</p>
:ET