I"0]<h1 id="lecture-04--分类">Lecture 04  分类</h1>

<p><strong>参考教材</strong>：</p>

<ul>
  <li><em>Gareth, J., Daniela, W., Trevor, H., &amp; Robert, T. (2013). An intruduction to statistical learning: with applications in R. Spinger.</em></li>
  <li><em>Hastie, T., Tibshirani, R., &amp; Friedman, J. (2009). The elements of statistical learning: data mining, inference, and prediction. Spinger Science &amp; Business Media.</em></li>
</ul>

<h2 id="1-分类问题概述">1. 分类问题概述</h2>

<p>上节课中我们所讨论的线性回归模型假设响应变量 $Y$ 是定量的，但很多情况下，响应变量是 <strong>定性的 (qualitative)</strong>。例如，眼睛颜色是定性变量，取值蓝色或棕色。定性变量又称 <strong>分类 (categorical)</strong> 变量。本节课我们将学习预测定性响应变量的方法及 <strong>分类 (classification)</strong> 过程。预测一个观测的定性响应值也指对观测 <strong>分类 (classify)</strong>，因为它涉及将观测分配到一个类别中。另一方面，大部分的分类方法先从预测定性变量不同类别的概率开始，将分类问题作为概率估计的一个结果。从这个角度上看，分类与回归方法有许多类似之处。</p>

<p>如今许多 <strong>分类器 (calssifier)</strong> 已被开发出来用于预测定性响应变量值。我们之前已经接触过一部分，这节课中，我们将讨论三种应用最广泛的分类方法：<strong>逻辑回归 (logistìc regression)</strong>、<strong>线性判别分析 (linear discriminant analysis)</strong> 和 <strong>$K$ 最近邻 ($K$-nearest neighbours)</strong>。在后面课程中，我们将会讨论更多的数据密集型计算方法，例如广义可加模型、基于树的方法、随机森林、boosting，以及支持向量机。</p>

<p>定性变量取值为 <strong>无序集合 $\mathcal C$</strong> 中的值，例如：</p>

<ul>
  <li>$\texttt{eye color}\in\{\mathtt{brown, blue, green}\}$</li>
  <li>$\texttt{email}\in\{\mathtt{spam, ham}\}$</li>
</ul>

<p>给定一个特征向量 $X$ 和一个定性响应 $Y$，其中响应变量 $Y$ 在集合 $\mathcal C$ 中取值。分类任务就是构建一个函数 $C(X)$，该函数将特征向量 $X$ 作为输入并预测其 $Y$ 值；即 $C(X) \in \mathcal C$。</p>

<p>通常，我们更感兴趣的是对 $X$ 属于 $\mathcal C$ 中每个类别的 <strong>概率</strong> 进行估计。</p>

<p>例如，对保险索赔是欺诈的概率进行估计要比将其直接分类为是否欺诈更具实际意义。</p>

<h3 id="例子信用卡违约">例子：信用卡违约</h3>

<p><img src="http://andy-blog.oss-cn-beijing.aliyuncs.com/blog/2020-11-07-WX20201107-132447%402x.png" width="80%" /></p>

<p><span style="font-size:10pt"> <span style="color:steelblue;font-weight:bold">图 1</span>：<code class="language-plaintext highlighter-rouge">Default</code> 数据集。<strong>左图</strong>：部分个体的年收入与月信用卡余额关系。信用卡违约的个体标记为 “$+$”，未违约的个体标记为 “$\circ$”。<strong>中图</strong>：<code class="language-plaintext highlighter-rouge">default</code> 关于 <code class="language-plaintext highlighter-rouge">balance</code> 函数的箱型图。<strong>右图</strong>：<code class="language-plaintext highlighter-rouge">default</code> 关于 <code class="language-plaintext highlighter-rouge">income</code> 函数的箱型图。</span></p>

<h2 id="2-为什么线性回归不可用">2. 为什么线性回归不可用</h2>

<p>假设在上面的 <code class="language-plaintext highlighter-rouge">Default</code> 分类任务中，我们将响应变量编码为：</p>

<script type="math/tex; mode=display">% <![CDATA[
Y=\begin{cases}0 & \text{if }\texttt{NO} \\[2ex] 1 & \text{if }\texttt{YES}\end{cases} %]]></script>

<p>我们可以简单地对 $X$ 进行 $Y$ 的线性回归，并且如果 $Y&gt; 0.5$ 就将其分类为 $\texttt{YES}$ 吗？</p>

<ul>
  <li>在这种二元结果的情况下，线性回归可以很好地用作分类器，并且它等效于我们稍后将讨论的 <strong>线性判别分析</strong>。</li>
  <li>由于总体的 $E(Y\mid X=x)=\Pr (Y=1\mid X=x)$，我们可能认为回归可以完美解决此任务。</li>
  <li>然而，<strong>线性</strong> 回归可能会产生小于 $0$ 或大于 $1$ 的概率。因此，<strong>逻辑回归 (logistic regression)</strong> 更为合适。</li>
</ul>

<p><img src="http://andy-blog.oss-cn-beijing.aliyuncs.com/blog/2020-11-07-WX20201107-134623%402x.png" width="80%" /></p>

<p><span style="font-size:10pt"> <span style="color:steelblue;font-weight:bold">图 2</span>：<code class="language-plaintext highlighter-rouge">Default</code> 数据分类。<strong>左图</strong>：线性回归估计的 <code class="language-plaintext highlighter-rouge">default</code> 概率。可以看到，其中一些数据上估计的概率值是负数。橙色标记表示按照 $0/1$ 编码的 <code class="language-plaintext highlighter-rouge">default</code> 值 ($\texttt{NO}$ 或 $\texttt{YES}$)。<strong>右图</strong>：逻辑回归预测的 <code class="language-plaintext highlighter-rouge">default</code> 概率，所有估计的概率均落在 $0$ 到 $1$ 之间。</span></p>

<p>橙色标记表示响应 $Y$ 为 $0$ 或 $1$。可以看到，线性回归无法很好地估计 $\Pr(Y=1\mid X)$，而逻辑回归似乎非常适合该任务。</p>

<p>现在，假设我们有一个具有三种可能值的响应变量。例如，对于急诊室中的病人，我们需要根据他们的症状对其进行分类：<code class="language-plaintext highlighter-rouge">stroke</code> (中风)、<code class="language-plaintext highlighter-rouge">drug overdose</code> (服药过量) 和 <code class="language-plaintext highlighter-rouge">epileptic seizure</code> (癫痫发作)。考虑用一个定量的响应变量 $Y$ 对这些值编码：</p>

<script type="math/tex; mode=display">% <![CDATA[
Y=\begin{cases}1 & \text{if }\texttt{stroke} \\[2ex] 2 & \text{if }\texttt{drug overdose}\\[2ex] 3 & \text{if }\texttt{epileptic seizure}\end{cases} %]]></script>

<p>我们可以根据这些编码，并结合一系列预测变量 $X_1,\dots,X_p$ 通过最小二乘法建立线性回归模型来预测 $Y$。</p>

<p>但是，这种做法存在一个问题：上面的编码方式实际默认了一个有序的输出，它实际上暗示了 <code class="language-plaintext highlighter-rouge">stroke</code> 和 <code class="language-plaintext highlighter-rouge">drug overdose</code> 之间的差异与 <code class="language-plaintext highlighter-rouge">drug overdose</code> 和 <code class="language-plaintext highlighter-rouge">epileptic seizure</code> 之间的差异是相同的。然而，实际上并没有特别的原因必需这样，我们同样可以选择另一种编码顺序。对一个二元定性响应变量而言，这种做法不会影响最终结果，例如，病人的身体状况只有两种可能 <code class="language-plaintext highlighter-rouge">stroke</code> 和 <code class="language-plaintext highlighter-rouge">drug overdose</code>，这种情况下，即使我们改变编码顺序，线性回归最后依然会给出相同的结果。然而，对于两个以上水平的响应变量而言，不同的编码顺序将产生完全不同的线性模型，继而导致对于同一测试观测产生不同的预测类别。</p>

<p>如果响应变量值确实存在一个自然的程度顺序，例如温和、中等和剧烈，并且温和和中等的程度差距与中等和剧烈的程度差距是相近的，那么将其编码为 $1,2,3$ 是合理的。但是请注意，<strong>通常我们不能将一个定性的响应变量自然地转换为两个水平以上的定量变量来建立回归模型。</strong></p>

<p>这种情况下，线性回归不再适用。<strong>多类别逻辑回归 (Multiclass Logistic Regression)</strong> 或者 <strong>判别分析 (Discriminant Analysis)</strong> 更为合适。</p>

<h2 id="3-逻辑回归">3. 逻辑回归</h2>

<h3 id="31-逻辑回归模型">3.1 逻辑回归模型</h3>

<p>为了简化，我们记 $p(X)=\Pr(Y=1\mid X)$。考虑利用 <code class="language-plaintext highlighter-rouge">balance</code> 预测 <code class="language-plaintext highlighter-rouge">default</code>。</p>

<p>如前所述，线性回归在处理分类问题时无法保证结果概率落在 $0$ 到 $1$ 之间，为避免这类问题，我们必须找到一个函数建立针对 $p(X)$ 的模型，使对任意 $X$ 值该函数的输出结果都在 $0$ 和 $1$ 之间。</p>

<p>有许多函数可以满足上述要求。在逻辑回归中，采用以下 <strong>逻辑函数 (logistic function)</strong> 形式：</p>

<script type="math/tex; mode=display">p(X)=\dfrac{e^{\beta_0 + \beta_1 X}}{1+ e^{\beta_0 + \beta_1 X}}</script>

<p>可以看到，无论 $\beta_0$、$\beta_1$ 或 $X$ 取值如何，$p(X)$ 的值始终落在 $0$ 到 $1$ 之间。</p>

<p>通过整理，可得</p>

<script type="math/tex; mode=display">\log \left(\dfrac{p(X)}{1-p(X)}\right)=\beta_0 + \beta_1 X</script>

<p>这种单调变换称为 $p(X)$ 的 <strong>对数几率 (log odds)</strong> 或 <strong>分对数 (logit)</strong>。</p>

<h3 id="32-估计回归系数">3.2 估计回归系数</h3>

<p>我们使用 <strong>最大似然 (maximum likelihood)</strong> 对模型参数进行估计。</p>

<p>其基本思想是：寻找 $\beta_0$ 和 $\beta_1$ 的一个估计，使得通过逻辑函数得到的每个人的违约预测概率 $\hat p(x_i)$ 最大可能地与违约的观测情况接近。即，求出的估计 $\hat \beta_0$ 和 $\hat \beta_1$，使得所有违约人的值接近于 $1$ ，而来违约大的值接近于 $0$。</p>

<p>这可以通过 <strong>似然函数 (likelihood function)</strong> 表述，其形式如下：</p>

<script type="math/tex; mode=display">\ell (\beta_0,\beta_1) = \prod_{i:y_i=1}p(x_i)\prod_{i:y_i=0}(1- p(x_i))</script>

<p>它给出了在数据中已观察到的 $0$ 和 $1$ 的概率。我们选择能够使观测数据的似然函数最大化的 $\beta_0$ 和 $\beta_1$。</p>

<p>大多数统计软件包都可以通过最大似然拟合线性逻辑回归模型。在 R 中，我们可以使用 <code class="language-plaintext highlighter-rouge">glm()</code> 函数来拟合逻辑回归模型。</p>

<p>表 1 显示了 <code class="language-plaintext highlighter-rouge">Default</code> 数据中，建立用 <code class="language-plaintext highlighter-rouge">balance</code> 预测 <code class="language-plaintext highlighter-rouge">default = YES</code> 概率的逻辑回归模型的系数估计和其他相关信息。可以看到，$\hat \beta_1 =0.0055$，这表示信用卡余额 <code class="language-plaintext highlighter-rouge">bal­ance</code> 越多，发生违约 <code class="language-plaintext highlighter-rouge">default</code> 的概率就越大。更准确地说，<code class="language-plaintext highlighter-rouge">balance</code> 每增加一个单位，<code class="language-plaintext highlighter-rouge">default</code> 的 log odds 就增加 $0.0055$ 个单位。</p>

<p><span style="font-size:10pt"> <span style="color:steelblue;font-weight:bold">表 1</span>：在 <code class="language-plaintext highlighter-rouge">Default</code> 数据中，建立用 <code class="language-plaintext highlighter-rouge">balance</code> 预测 <code class="language-plaintext highlighter-rouge">default</code> 概率的逻辑回归模型的系数估计。<code class="language-plaintext highlighter-rouge">balance</code> 每增加一个单位，<code class="language-plaintext highlighter-rouge">default</code> 的 log odds 增加 $0.0055$ 个单位。</span></p>

<table>
  <thead>
    <tr>
      <th> </th>
      <th style="text-align: center">系数</th>
      <th style="text-align: center">标准误</th>
      <th style="text-align: center">$Z$ 统计量</th>
      <th style="text-align: center">p 值</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">Intercept</code></td>
      <td style="text-align: center">$-10.6513$</td>
      <td style="text-align: center">$0.3612$</td>
      <td style="text-align: center">$-29.5$</td>
      <td style="text-align: center">$&lt; 0.0001$</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">balance</code></td>
      <td style="text-align: center">$0.0055$</td>
      <td style="text-align: center">$0.0002$</td>
      <td style="text-align: center">$24.9$</td>
      <td style="text-align: center">$&lt; 0.0001$</td>
    </tr>
  </tbody>
</table>

<p>表 1 中逻辑回归模型的输出结果与之前的线性回归输出的结果是类似的。例如，系数估计的准确性可通过计算标准误来衡量。表 1 中的 $Z$ 统计量和线性回归模型输出的 $t$ 统计量的作用是一样的，如 $\beta_1$ 的 $Z$ 统计量等于 $\hat \beta_1 / SE(\hat \beta_1)$。当 $Z$ 统计量的绝对值很大时，说明零假设 $H_0: \beta_1=0$ 不成立。零假设也就是 $p(X)=\frac{e^{\beta_0}}{1+e^{\beta_0}}$，表示 <code class="language-plaintext highlighter-rouge">default</code> 概率不依赖于 <code class="language-plaintext highlighter-rouge">balance</code>。由于表 1 中 <code class="language-plaintext highlighter-rouge">balance</code> 的 p 值很小，因此拒绝 $H_0$，表明 <code class="language-plaintext highlighter-rouge">default</code> 概率与 <code class="language-plaintext highlighter-rouge">balance</code> 之间确实存在关系。另外，这里截距项估计通常意义不大，主要作用是调节平均拟合概率使之与真实数据实际 odds 更接近。</p>

<h3 id="33-预测">3.3 预测</h3>

<p>对于某个信用卡余额 <code class="language-plaintext highlighter-rouge">balance</code> 为 $1000$ 美元的个体，其估计的违约 <code class="language-plaintext highlighter-rouge">default = YES</code> 概率是多少？</p>

<script type="math/tex; mode=display">\hat p(X)=\dfrac{e^{\hat \beta_0 + \hat \beta_1 X}}{1+e^{\hat \beta_0 + \hat \beta_1 X}}=\dfrac{e^{-10.6513 + 0.0055\times 1000}}{1+e^{-10.6513 + 0.0055\times 1000}}=0.006</script>

<p>对于 <code class="language-plaintext highlighter-rouge">balance</code> 为 $2000$ 美元的个体呢？</p>

<script type="math/tex; mode=display">\hat p(X)=\dfrac{e^{\hat \beta_0 + \hat \beta_1 X}}{1+e^{\hat \beta_0 + \hat \beta_1 X}}=\dfrac{e^{-10.6513 + 0.0055\times 2000}}{1+e^{-10.6513 + 0.0055\times 2000}}=0.586</script>

<p>可见，对于某个个体，信用卡余额 (<code class="language-plaintext highlighter-rouge">balance</code>) 越高，其违约 (<code class="language-plaintext highlighter-rouge">default = YES</code>) 的概率也越高。</p>

<p>另外，我们还可以尝试用定性预测变量 <code class="language-plaintext highlighter-rouge">student</code> 来拟合逻辑回归模型。我们将 <code class="language-plaintext highlighter-rouge">student</code> 编码为一个虚拟变量 <code class="language-plaintext highlighter-rouge">student [YES]</code>：学生为 $1$，非学生为 $0$。表 2 给出了用 <code class="language-plaintext highlighter-rouge">student</code> 预测 <code class="language-plaintext highlighter-rouge">default</code> 概率的逻辑回归模型的结果，可以看出虚拟变量的系数值是正的，其 p 值也是显著的。这表明学生比非学生更容易违约。</p>

<p><span style="font-size:10pt"> <span style="color:steelblue;font-weight:bold">表 2</span>：在 <code class="language-plaintext highlighter-rouge">Default</code> 数据中，建立用 <code class="language-plaintext highlighter-rouge">student</code> 预测 <code class="language-plaintext highlighter-rouge">default</code> 概率的逻辑回归模型的系数估计。<code class="language-plaintext highlighter-rouge">student</code> 用一个虚拟变量 <code class="language-plaintext highlighter-rouge">student [YES]</code> 编码，$1$ 代表学生，$0$ 代表非学生。</span></p>

<table>
  <thead>
    <tr>
      <th> </th>
      <th style="text-align: center">系数</th>
      <th style="text-align: center">标准误</th>
      <th style="text-align: center">$Z$ 统计量</th>
      <th style="text-align: center">p 值</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">Intercept</code></td>
      <td style="text-align: center">$-3.5041$</td>
      <td style="text-align: center">$0.0707$</td>
      <td style="text-align: center">$-49.55$</td>
      <td style="text-align: center">$&lt; 0.0001$</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">student [YES]</code></td>
      <td style="text-align: center">$0.4049$</td>
      <td style="text-align: center">$0.1150$</td>
      <td style="text-align: center">$3.52$</td>
      <td style="text-align: center">$0.0004$</td>
    </tr>
  </tbody>
</table>

<script type="math/tex; mode=display">\widehat{\Pr}(\texttt{default}=\texttt{YES} \mid \texttt{student}=\texttt{YES})=\dfrac{e^{-3.5041+0.4049\times 1}}{1+e^{-3.5041+0.4049\times 1}}=0.0431</script>

<script type="math/tex; mode=display">\widehat{\Pr}(\texttt{default}=\texttt{YES} \mid \texttt{student}=\texttt{NO})=\dfrac{e^{-3.5041+0.4049\times 0}}{1+e^{-3.5041+0.4049\times 0}}=0.0292</script>

<p>可以看到，学生比非学生违约概率更大。</p>

<h3 id="34-多元逻辑回归">3.4 多元逻辑回归</h3>

<p>现在考虑预测一个二元响应变量受多个因素影响的情况。类似于之前的多元线性回归，我们可以将二元逻辑回归推广到多元情况：</p>

<script type="math/tex; mode=display">\log \left(\dfrac{p(X)}{1-p(X)}\right)=\beta_0 + \beta_1 X_1 + \cdots + \beta_p X_p</script>

<p>这里，$X=(X_1,\dots,X_p)$ 表示 $p$ 个预测变量，这种情况下，逻辑函数为：</p>

<script type="math/tex; mode=display">p(X)=\dfrac{e^{\beta_0 + \beta_1 X_1 + \cdots + \beta_p X_p}}{1+ e^{\beta_0 + \beta_1 X_1 + \cdots + \beta_p X_p}}</script>

<p>和之前一样，我们可以通过最大似然方法估计系数 $\beta_0,\beta_1,\dots,\beta_p$。</p>

<p>表 3 给出了用 <code class="language-plaintext highlighter-rouge">balance</code>、<code class="language-plaintext highlighter-rouge">income</code> 和 <code class="language-plaintext highlighter-rouge">student</code> 三个预测变量对 <code class="language-plaintext highlighter-rouge">default</code> 概率建立的逻辑回归模型的系数估计。</p>

<p><span style="font-size:10pt"> <span style="color:steelblue;font-weight:bold">表 3</span>：在 <code class="language-plaintext highlighter-rouge">Default</code> 数据中，结合 <code class="language-plaintext highlighter-rouge">balance</code>、<code class="language-plaintext highlighter-rouge">income</code>、<code class="language-plaintext highlighter-rouge">student</code> 三个预测变量建立的预测 <code class="language-plaintext highlighter-rouge">default</code> 概率的逻辑回归模型的系数估计。<code class="language-plaintext highlighter-rouge">student</code> 用一个虚拟变量 <code class="language-plaintext highlighter-rouge">student [YES]</code> 编码，$1$ 代表学生，$0$ 代表非学生。<code class="language-plaintext highlighter-rouge">income</code> 的单位为千美元。</span></p>

<table>
  <thead>
    <tr>
      <th> </th>
      <th style="text-align: center">系数</th>
      <th style="text-align: center">标准误</th>
      <th style="text-align: center">$Z$ 统计量</th>
      <th style="text-align: center">p 值</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">Intercept</code></td>
      <td style="text-align: center">$-10.8690$</td>
      <td style="text-align: center">$0.4923$</td>
      <td style="text-align: center">$-22.08$</td>
      <td style="text-align: center">$&lt; 0.0001$</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">balance</code></td>
      <td style="text-align: center">$0.0057$</td>
      <td style="text-align: center">$0.0002$</td>
      <td style="text-align: center">$24.74$</td>
      <td style="text-align: center">$&lt; 0.0001$</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">income</code></td>
      <td style="text-align: center">$0.0030$</td>
      <td style="text-align: center">$0.0082$</td>
      <td style="text-align: center">$0.37$</td>
      <td style="text-align: center">$0.7115$</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">student [YES]</code></td>
      <td style="text-align: center">$-0.6468$</td>
      <td style="text-align: center">$0.2362$</td>
      <td style="text-align: center">$-2.74$</td>
      <td style="text-align: center">$0.0062$</td>
    </tr>
  </tbody>
</table>

<p>表 3 的结果有点出乎意料。其中 <code class="language-plaintext highlighter-rouge">balance</code> 和 <code class="language-plaintext highlighter-rouge">student [YES]</code> 的 p 值很小，意味着两者对 <code class="language-plaintext highlighter-rouge">default</code> 概率是有影响的。然而这里 <code class="language-plaintext highlighter-rouge">student [YES]</code> 系数是负数，说明学生要比非学生的违约概率更低，这似乎和我们之前在单变量逻辑回归中得到的结论相矛盾。</p>

<p><img src="http://andy-blog.oss-cn-beijing.aliyuncs.com/blog/2020-11-07-WX20201107-155801%402x.png" width="80%" /></p>

<p><span style="font-size:10pt"> <span style="color:steelblue;font-weight:bold">图 3</span>：<code class="language-plaintext highlighter-rouge">Default</code> 数据集的混淆现象。<strong>左图</strong>：学生 (橙色) 与非学生 (蓝色) 的违约率。实线表示违约率与 <code class="language-plaintext highlighter-rouge">balance</code> 的函数关系，水平虚线是考虑所有变量时的违约率。<strong>右图</strong>：学生 (橙色) 与非学生 (蓝色) 的 <code class="language-plaintext highlighter-rouge">balance</code> 的箱型图。</span></p>

<p>图 3 对这个看似矛盾的问题从图像上给予解释：</p>

<ul>
  <li>通常，学生的 <code class="language-plaintext highlighter-rouge">balance</code> 要比非学生高，因此学生的边缘违约率 (marginal default rate) 要高于非学生。</li>
  <li>但是，对于每个余额水平，学生的违约率均低于非学生。</li>
</ul>

<p>多元逻辑回归可以解决这个问题。</p>

<p>但在表.4-2 中学生哑变蠢的系数却是正值。为什</p>

<p>么在表 4-2 中学生身份会增加违约的概率而在我 4-3 中学生身份会降低违约概率? 00 4-3 中在</p>

<p>图对这个看似矛盾的问题从图像上给予解释。其中橙色和蓝色的折线分别表示学生身份和非学</p>

<p>生身份的平均违约率关于信用卡余额的函数。在这个多元的逻辑斯谛回归模型中，哑变盘 student 的翠数是负的说明考虑到 balance 和 income 两个因素的作用，学生身份相较于非</p>

<p>学生身份更不易发生违约。实际上，从图 4-3 的左隧可以看出无论 balance 取什么傻，学生</p>

<p>违约率始终不高于非学生违约率。但是闺中接近底端的水平虚线代表着对所有 balance 和 川come 来说，学生平均的违约率和非学生的平均违约率，这望的结果与前面格反.学生身份</p>

<p>总体的违约率比非学生身份寓。所以在建立单个吸变蠢 student 的逻辑斯谛回归模型输出 (见表 4-2) 时，学生身份变蜜的系数是正的。</p>

<p>下节内容：分类</p>
:ET